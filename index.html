<!DOCTYPE html>
<html lang="he">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finely</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <style>
      :root {
        --font-size-base: 16px;
        --font-scale: 1;
        --section-scale: 1;
        --primary-color: #007bff;
        --secondary-color: #6c757d;
        --dark-bg: #1a1a2e;
        --dark-accent: #60a5fa;
      }
      body {
        font-family: "Rubik", sans-serif;
        font-size: calc(var(--font-size-base) * var(--font-scale));
        transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out;
        position: relative;
        overflow-x: hidden;
      }
      .container {
        max-width: calc(1000px * var(--section-scale));
        width: 100%;
        padding-left: calc(15px * var(--section-scale));
        padding-right: calc(15px * var(--section-scale));
      }
      .dark-mode {
        background: linear-gradient(
          135deg,
          var(--dark-bg) 0%,
          #16213e 100%
        ) !important;
        color: #ffffff !important;
      }
      .dark-mode .bg-light {
        background: rgba(52, 58, 64, 0.95) !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3),
          inset 0 2px 5px rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .dark-mode .text-dark {
        color: #ffffff !important;
      }
      .dark-mode .table {
        color: #ffffff !important;
      }
      .dark-mode .table-bordered {
        border-color: rgba(255, 255, 255, 0.2) !important;
      }
      .dark-mode .table thead th {
        background: rgba(73, 80, 87, 0.8) !important;
        color: #ffffff !important;
      }
      .dark-mode .card {
        background: rgba(52, 58, 64, 0.95) !important;
        color: #ffffff !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3),
          inset 0 2px 5px rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transform: scale(var(--section-scale));
      }
      .dark-mode .form-control,
      .dark-mode .form-select {
        background: rgba(73, 80, 87, 0.8) !important;
        color: #ffffff !important;
        border-color: rgba(255, 255, 255, 0.2) !important;
        font-size: calc(var(--font-size-base) * var(--font-scale));
        padding: calc(0.375rem * var(--font-scale))
          calc(0.75rem * var(--font-scale));
      }
      .dark-mode .btn-outline-secondary {
        color: #ffffff !important;
        border-color: rgba(255, 255, 255, 0.2) !important;
      }
      .dark-mode .btn-outline-primary {
        border-color: var(--dark-accent);
        color: var(--dark-accent);
      }
      .dark-mode .btn-outline-primary:hover {
        background-color: rgba(96, 165, 250, 0.1);
      }
      .dark-mode .about-tooltip {
        background-color: #343a40;
        color: #ffffff;
      }
      .dark-mode .footer {
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }
      .offcanvas {
        transition: transform 0.3s ease-in-out;
      }
      .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
        font-size: calc(0.9rem * var(--font-scale));
        padding: calc(0.5rem * var(--font-scale)) calc(1rem * var(--font-scale));
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }
      .btn-primary:hover {
        background-color: #0056b3;
        border-color: #0056b3;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }
      .dark-mode .btn-primary {
        background-color: var(--dark-accent);
        border-color: var(--dark-accent);
      }
      .dark-mode .btn-primary:hover {
        background-color: #3b82f6;
        border-color: #3b82f6;
      }
      .btn-primary.position-fixed {
        font-size: calc(1.2rem * var(--font-scale));
        padding: calc(0.4rem * var(--font-scale));
        width: calc(40px * var(--section-scale));
        height: calc(40px * var(--section-scale));
        border-radius: 4px;
        z-index: 1000;
        top: calc(10px * var(--section-scale));
        right: calc(10px * var(--section-scale));
      }
      .btn-nav {
        color: var(--primary-color);
        background-color: transparent;
        border: 1px solid transparent;
        border-radius: 4px;
        padding: calc(0.5rem * var(--font-scale)) calc(1rem * var(--font-scale));
        font-size: calc(1rem * var(--font-scale));
        transition: color 0.3s ease, border-color 0.3s ease;
        margin: calc(0.5rem * var(--section-scale)) 0;
      }
      .btn-nav:hover {
        color: #0056b3;
        border-color: #007bff;
      }
      .btn-nav.active {
        color: #0056b3;
        border-color: #007bff;
      }
      .dark-mode .btn-nav {
        color: var(--dark-accent);
      }
      .dark-mode .btn-nav:hover,
      .dark-mode .btn-nav.active {
        color: #3b82f6;
        border-color: var(--dark-accent);
      }
      .btn-settings {
        background-color: var(--primary-color);
        color: #ffffff;
        border-radius: 50%;
        width: calc(45px * var(--section-scale));
        height: calc(45px * var(--section-scale));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: calc(1.2rem * var(--font-scale));
        transition: background-color 0.3s ease;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }
      .btn-settings:hover {
        background-color: #0056b3;
      }
      .dark-mode .btn-settings {
        background-color: var(--dark-accent);
      }
      .dark-mode .btn-settings:hover {
        background-color: #3b82f6;
      }
      .btn-success {
        white-space: nowrap;
        padding: calc(0.4rem * var(--font-scale))
          calc(0.8rem * var(--font-scale));
        font-size: calc(0.9rem * var(--font-scale));
      }
      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .chart-container {
        display: flex;
        align-items: center;
        justify-content: center;
        max-width: calc(600px * var(--section-scale));
        margin: 0 auto;
        padding: calc(20px * var(--section-scale)) 0;
      }
      .svg-pie-chart {
        width: calc(300px * var(--section-scale));
        height: calc(300px * var(--section-scale));
        flex-shrink: 0;
      }
      .svg-pie-chart path {
        transition: opacity 0.2s ease;
      }
      .svg-pie-chart path:hover {
        opacity: 0.8;
      }
      .legend-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        max-width: calc(200px * var(--section-scale));
        margin-right: calc(20px * var(--section-scale));
      }
      .legend-item {
        display: flex;
        align-items: center;
        margin: calc(8px * var(--section-scale));
        font-size: calc(16px * var(--font-scale));
      }
      .legend-color {
        width: calc(20px * var(--section-scale));
        height: calc(20px * var(--section-scale));
        margin-left: calc(10px * var(--section-scale));
        border-radius: calc(4px * var(--section-scale));
      }
      .background-svg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        opacity: 0.2;
      }
      .background-svg path,
      .background-svg circle,
      .background-svg text {
        stroke: var(--primary-color);
        fill: none;
        stroke-width: 2;
        animation: draw 6s infinite alternate;
      }
      .dark-mode .background-svg path,
      .dark-mode .background-svg circle,
      .dark-mode .background-svg text {
        stroke: var(--dark-accent);
      }
      @keyframes draw {
        0% {
          stroke-dashoffset: 100;
        }
        100% {
          stroke-dashoffset: 0;
        }
      }
      h1 {
        font-weight: 700 !important;
        font-size: calc(3.2rem * var(--font-scale)); /* הגדלה משמעותית */
        background: linear-gradient(135deg, var(--primary-color), #cc5de8);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        animation: pulse 2s infinite;
        text-align: center;
        margin-bottom: calc(2rem * var(--section-scale));
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
        100% {
          transform: scale(1);
        }
      }
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-weight: 700 !important;
      }
      .category-summary .d-flex {
        padding: calc(4px * var(--section-scale)) 0;
        margin: 0;
        gap: calc(10px * var(--section-scale));
      }
      .category-summary hr {
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        margin: calc(8px * var(--section-scale)) 0;
      }
      .dark-mode .category-summary hr {
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }
      .collapse-toggle {
        background: none;
        border: none;
        color: inherit;
        font-size: calc(1.2rem * var(--font-scale));
        transition: transform 0.3s ease;
        width: 100%;
        text-align: end;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .collapse-toggle .bi-chevron-down {
        transition: transform 0.3s ease;
      }
      .collapse-toggle.collapsed .bi-chevron-down {
        transform: rotate(180deg);
      }
      .toast-container {
        position: fixed;
        top: calc(20px * var(--section-scale));
        right: calc(20px * var(--section-scale));
        z-index: 1055;
      }
      .toast {
        background-color: var(--primary-color);
        color: #ffffff;
        border: none;
        font-size: calc(14px * var(--font-scale));
      }
      .dark-mode .toast {
        background-color: var(--dark-accent);
      }
      .toast-header strong {
        margin-left: auto;
      }
      .card-header {
        cursor: pointer;
      }
      .table th,
      .table td {
        font-size: calc(14px * var(--font-scale));
        padding: calc(8px * var(--section-scale));
      }
      .modal-content {
        transform: scale(var(--section-scale));
      }
      .about-icon {
        position: absolute;
        top: calc(2.5rem * var(--section-scale));
        left: calc(1rem * var(--section-scale));
        font-size: calc(1.5rem * var(--font-scale));
        color: var(--primary-color);
        cursor: pointer;
      }
      .dark-mode .about-icon {
        color: var(--dark-accent);
      }
      .about-tooltip {
        display: none;
        position: absolute;
        top: calc(2.5rem * var(--section-scale));
        left: calc(2rem * var(--section-scale));
        background-color: #f8f9fa;
        color: #212529;
        padding: calc(0.5rem * var(--font-scale));
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        font-size: calc(0.9rem * var(--font-scale));
        max-width: calc(400px * var(--section-scale));
        white-space: normal;
        line-height: 1.5;
        z-index: 1000;
      }
      .about-icon:hover .about-tooltip {
        display: block;
      }
      .footer {
        text-align: center;
        padding: calc(0.5rem * var(--section-scale));
        margin-top: calc(2rem * var(--section-scale));
        font-size: calc(0.9rem * var(--font-scale));
        border-top: 1px solid rgba(0, 0, 0, 0.1);
      }
      .insights-list {
        list-style-type: none;
        padding: 0;
      }
      .insights-list li {
        padding: calc(0.5rem * var(--font-scale));
        margin-bottom: calc(0.5rem * var(--section-scale));
        background-color: rgba(0, 123, 255, 0.1);
        border-radius: 4px;
        font-size: calc(0.9rem * var(--font-scale));
      }
      .dark-mode .insights-list li {
        background-color: rgba(96, 165, 250, 0.1);
      }
    </style>
  </head>
  <body class="bg-light">
    <svg
      class="background-svg"
      viewBox="0 0 1000 1000"
      preserveAspectRatio="xMidYMid slice"
    >
      <path d="M200,300 Q300,200 400,300 T600,300" stroke-dasharray="50,50" />
      <circle cx="300" cy="400" r="20" stroke-dasharray="10,10" />
      <path d="M500,500 Q600,400 700,500 T900,500" stroke-dasharray="30,30" />
      <circle cx="700" cy="600" r="15" stroke-dasharray="5,5" />
      <path
        d="M100,600 L200,700 L300,600 L400,700 L500,600"
        stroke-dasharray="20,20"
      />
      <circle cx="500" cy="300" r="25" stroke-dasharray="15,15" />
      <path
        d="M150,150 L150,250 L200,200 L250,250 L250,150"
        stroke-dasharray="10,10"
      />
      <text
        x="800"
        y="200"
        font-size="40"
        stroke-width="1"
        stroke-dasharray="5,5"
      >
        ₪
      </text>
      <path d="M750,700 Q800,650 850,700 T950,700" stroke-dasharray="40,40" />
    </svg>
    <div id="root" dir="rtl"></div>
    <script>
      const { useState, useEffect, useRef } = React;

      const FinanceApp = () => {
        const [transactions, setTransactions] = useState([]);
        const [savings, setSavings] = useState([]);
        const [description, setDescription] = useState("");
        const [amount, setAmount] = useState("");
        const [type, setType] = useState("expense");
        const [category, setCategory] = useState("");
        const [filterType, setFilterType] = useState("all");
        const [filterCategory, setFilterCategory] = useState("all");
        const [filterDateStart, setFilterDateStart] = useState("");
        const [filterDateEnd, setFilterDateEnd] = useState("");
        const [darkMode, setDarkMode] = useState(true);
        const [fontSize, setFontSize] = useState("medium");
        const [error, setError] = useState("");
        const [savingsName, setSavingsName] = useState("");
        const [savingsAmount, setSavingsAmount] = useState("");
        const [savingsLocation, setSavingsLocation] = useState("");
        const [savingsError, setSavingsError] = useState("");
        const [activeTab, setActiveTab] = useState("transactions");
        const [editTransaction, setEditTransaction] = useState(null);
        const [editDescription, setEditDescription] = useState("");
        const [editAmount, setEditAmount] = useState("");
        const [editType, setEditType] = useState("expense");
        const [editCategory, setEditCategory] = useState("");
        const [editError, setEditError] = useState("");
        const savingsChartRef = useRef(null);
        const savingsChartInstance = useRef(null);

        const predefinedCategories = [
          "מזון",
          "תחבורה",
          "דיור",
          "בידור",
          "חינוך",
          "בריאות",
          "משכורת",
          "השקעות",
          "מתנות",
          "ביגוד",
          "נסיעות",
          "תקשורת",
          "פנאי",
          "ביטוח",
          "תחזוקה",
          "חשמל",
          "מים",
        ];
        const predefinedLocations = [
          "בנק",
          "קרן פנסיה",
          "תיק השקעות",
          "חשבון חיסכון",
          "מזומן",
        ];

        useEffect(() => {
          const savedTransactions = JSON.parse(
            localStorage.getItem("transactions") || "[]"
          );
          const savedSavings = JSON.parse(
            localStorage.getItem("savings") || "[]"
          );
          const savedDarkMode = JSON.parse(
            localStorage.getItem("darkMode") || "true"
          );
          const savedFontSize = localStorage.getItem("fontSize") || "medium";
          setTransactions(savedTransactions);
          setSavings(savedSavings);
          setDarkMode(savedDarkMode);
          setFontSize(savedFontSize);
        }, []);

        useEffect(() => {
          localStorage.setItem("transactions", JSON.stringify(transactions));
          localStorage.setItem("savings", JSON.stringify(savings));
          localStorage.setItem("darkMode", JSON.stringify(darkMode));
          localStorage.setItem("fontSize", fontSize);
          document.body.className = darkMode ? "bg-dark dark-mode" : "bg-light";
          const root = document.documentElement;
          root.style.setProperty(
            "--font-scale",
            fontSize === "small" ? 0.8 : fontSize === "large" ? 1.2 : 1
          );
          root.style.setProperty(
            "--section-scale",
            fontSize === "small" ? 0.9 : fontSize === "large" ? 1.1 : 1
          );
        }, [transactions, savings, darkMode, fontSize]);

        useEffect(() => {
          if (savingsChartRef.current && window.Chart) {
            const ctx = savingsChartRef.current.getContext("2d");
            const fontScale =
              parseFloat(
                getComputedStyle(document.documentElement).getPropertyValue(
                  "--font-scale"
                )
              ) || 1;
            if (savingsChartInstance.current) {
              savingsChartInstance.current.destroy();
            }
            savingsChartInstance.current = new window.Chart(ctx, {
              type: "line",
              data: {
                labels: savings.map((s) =>
                  new Date(s.date).toLocaleDateString("he-IL")
                ),
                datasets: [
                  {
                    label: "סך החסכונות",
                    data: savings.map((s) => s.amount),
                    borderColor: darkMode ? "#60a5fa" : "#007bff",
                    backgroundColor: darkMode
                      ? "rgba(96, 165, 250, 0.2)"
                      : "rgba(0, 123, 255, 0.2)",
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: "#ffffff",
                    pointBorderColor: darkMode ? "#60a5fa" : "#007bff",
                    pointHoverRadius: 8,
                  },
                ],
              },
              options: {
                responsive: true,
                scales: {
                  y: {
                    beginAtZero: true,
                    ticks: {
                      color: darkMode ? "#ffffff" : "#212529",
                      font: { size: 12 * fontScale },
                    },
                  },
                  x: {
                    ticks: {
                      color: darkMode ? "#ffffff" : "#212529",
                      font: { size: 12 * fontScale },
                    },
                  },
                },
                plugins: {
                  legend: {
                    labels: {
                      color: darkMode ? "#ffffff" : "#212529",
                      font: { size: 14 * fontScale },
                    },
                  },
                  tooltip: {
                    backgroundColor: darkMode ? "#343a40" : "#ffffff",
                    titleColor: darkMode ? "#ffffff" : "#212529",
                    bodyColor: darkMode ? "#ffffff" : "#212529",
                  },
                },
              },
            });
          }
        }, [savings, darkMode, fontSize]);

        const showToast = (message) => {
          const toastContainer = document.getElementById("toastContainer");
          const toastEl = document.createElement("div");
          toastEl.className = "toast";
          toastEl.setAttribute("role", "alert");
          toastEl.setAttribute("aria-live", "assertive");
          toastEl.setAttribute("aria-atomic", "true");
          toastEl.innerHTML = `
          <div class="toast-header">
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="סגור"></button>
            <strong class="ms-auto">הודעה</strong>
          </div>
          <div class="toast-body">${message}</div>
        `;
          toastContainer.appendChild(toastEl);
          const toast = new bootstrap.Toast(toastEl, {
            autohide: true,
            delay: 3000,
          });
          toast.show();
          toastEl.addEventListener("hidden.bs.toast", () => toastEl.remove());
        };

        const addTransaction = (e) => {
          e.preventDefault();
          if (!description.trim()) {
            setError("חובה להזין תיאור");
            return;
          }
          if (!amount || isNaN(amount) || parseFloat(amount) <= 0) {
            setError("חובה להזין סכום חיובי");
            return;
          }
          if (!category.trim()) {
            setError("חובה להזין קטגוריה");
            return;
          }
          const newTransaction = {
            id: Date.now(),
            description,
            amount: parseFloat(amount),
            type,
            category,
            date: new Date().toISOString().split("T")[0],
          };
          setTransactions([...transactions, newTransaction]);
          setDescription("");
          setAmount("");
          setCategory("");
          setError("");
          showToast("פעולה נוספה בהצלחה");
        };

        const addSavings = (e) => {
          e.preventDefault();
          if (!savingsName.trim()) {
            setSavingsError("חובה להזין שם חיסכון");
            return;
          }
          if (
            !savingsAmount ||
            isNaN(savingsAmount) ||
            parseFloat(savingsAmount) < 0
          ) {
            setSavingsError("חובה להזין סכום תקין");
            return;
          }
          if (!savingsLocation.trim()) {
            setSavingsError("חובה לבחור מיקום");
            return;
          }
          const newSavings = {
            id: Date.now(),
            name: savingsName,
            amount: parseFloat(savingsAmount),
            location: savingsLocation,
            date: new Date().toISOString().split("T")[0],
          };
          setSavings([...savings, newSavings]);
          setSavingsName("");
          setSavingsAmount("");
          setSavingsLocation("");
          setSavingsError("");
          showToast("חיסכון נוסף בהצלחה");
        };

        const deleteTransaction = (id) => {
          setTransactions(transactions.filter((t) => t.id !== id));
          showToast("פעולה נמחקה בהצלחה");
        };

        const deleteSavings = (id) => {
          setSavings(savings.filter((s) => s.id !== id));
          showToast("חיסכון נמחק בהצלחה");
        };

        const openEditModal = (transaction) => {
          setEditTransaction(transaction);
          setEditDescription(transaction.description);
          setEditAmount(transaction.amount.toString());
          setEditType(transaction.type);
          setEditCategory(transaction.category);
          setEditError("");
          const modal = new bootstrap.Modal(
            document.getElementById("editTransactionModal")
          );
          modal.show();
        };

        const editTransactionSubmit = (e) => {
          e.preventDefault();
          if (!editDescription.trim()) {
            setEditError("חובה להזין תיאור");
            return;
          }
          if (!editAmount || isNaN(editAmount) || parseFloat(editAmount) <= 0) {
            setEditError("חובה להזין סכום חיובי");
            return;
          }
          if (!editCategory.trim()) {
            setEditError("חובה להזין קטגוריה");
            return;
          }
          const updatedTransaction = {
            ...editTransaction,
            description: editDescription,
            amount: parseFloat(editAmount),
            type: editType,
            category: editCategory,
          };
          setTransactions(
            transactions.map((t) =>
              t.id === editTransaction.id ? updatedTransaction : t
            )
          );
          setEditTransaction(null);
          setEditDescription("");
          setEditAmount("");
          setEditType("expense");
          setEditCategory("");
          setEditError("");
          showToast("פעולה עודכנה בהצלחה");
          const modal = bootstrap.Modal.getInstance(
            document.getElementById("editTransactionModal")
          );
          modal.hide();
        };

        const openSettingsModal = () => {
          const modal = new bootstrap.Modal(
            document.getElementById("settingsModal")
          );
          modal.show();
        };

        const filteredTransactions = transactions.filter((t) => {
          const date = new Date(t.date);
          const start = filterDateStart ? new Date(filterDateStart) : null;
          const end = filterDateEnd ? new Date(filterDateEnd) : null;
          return (
            (filterType === "all" || t.type === filterType) &&
            (filterCategory === "all" || t.category === filterCategory) &&
            (!start || date >= start) &&
            (!end || date <= end)
          );
        });

        const totalIncome = filteredTransactions
          .filter((t) => t.type === "income")
          .reduce((sum, t) => sum + t.amount, 0);

        const totalExpenses = filteredTransactions
          .filter((t) => t.type === "expense")
          .reduce((sum, t) => sum + t.amount, 0);

        const balance = totalIncome - totalExpenses;

        const categorySummary = filteredTransactions.reduce((acc, t) => {
          acc[t.category] =
            (acc[t.category] || 0) +
            (t.type === "income" ? t.amount : -t.amount);
          return acc;
        }, {});

        const categoryData = predefinedCategories.reduce((acc, cat) => {
          const total = filteredTransactions
            .filter((t) => t.category === cat && t.type === "expense")
            .reduce((sum, t) => sum + t.amount, 0);
          if (total > 0) acc[cat] = total;
          return acc;
        }, {});
        const totalCategoryAmount = Object.values(categoryData).reduce(
          (sum, val) => sum + val,
          0
        );
        const pieChartData = Object.entries(categoryData).map(
          ([category, amount], index) => ({
            category,
            amount,
            color: darkMode
              ? [
                  "#ff6b6b",
                  "#4dabf7",
                  "#51cf66",
                  "#ff922b",
                  "#cc5de8",
                  "#339af0",
                  "#fab005",
                  "#868e96",
                  "#20c997",
                  "#f06595",
                  "#845ef7",
                  "#2b8a3e",
                  "#e03131",
                  "#364fc7",
                  "#f08c00",
                  "#087f5b",
                ][index % 16]
              : [
                  "#007bff",
                  "#6c757d",
                  "#51cf66",
                  "#ff922b",
                  "#cc5de8",
                  "#339af0",
                  "#fab005",
                  "#6c757d",
                  "#20c997",
                  "#f06595",
                  "#845ef7",
                  "#2b8a3e",
                  "#e03131",
                  "#364fc7",
                  "#f08c00",
                  "#087f5b",
                ][index % 16],
          })
        );

        const generatePieChart = () => {
          if (!totalCategoryAmount) {
            return React.createElement(
              "div",
              { className: "text-center text-muted" },
              "אין נתונים להצגה"
            );
          }
          let startAngle = 0;
          const centerX = 150;
          const centerY = 150;
          const radius = 100;
          const slices = pieChartData.map(({ category, amount, color }) => {
            const percentage = (amount / totalCategoryAmount) * 360;
            const endAngle = startAngle + percentage;
            const largeArc = percentage > 180 ? 1 : 0;
            const startX =
              centerX + radius * Math.cos((startAngle * Math.PI) / 180);
            const startY =
              centerY + radius * Math.sin((startAngle * Math.PI) / 180);
            const endX =
              centerX + radius * Math.cos((endAngle * Math.PI) / 180);
            const endY =
              centerY + radius * Math.sin((endAngle * Math.PI) / 180);
            const path = `M${centerX},${centerY} L${startX},${startY} A${radius},${radius} 0 ${largeArc},1 ${endX},${endY} Z`;
            startAngle = endAngle;
            return React.createElement("path", {
              key: category,
              d: path,
              fill: color,
              onMouseOver: (e) => {
                e.target.setAttribute("opacity", "0.8");
                const tooltip = document.createElement("div");
                tooltip.innerText = `${category}: ${amount.toFixed(2)} ₪`;
                tooltip.style.position = "absolute";
                tooltip.style.background = darkMode ? "#343a40" : "#ffffff";
                tooltip.style.color = darkMode ? "#ffffff" : "#212529";
                tooltip.style.padding = "5px 10px";
                tooltip.style.borderRadius = "5px";
                tooltip.style.boxShadow = "0 2px 5px rgba(0,0,0,0.2)";
                document.body.appendChild(tooltip);
                tooltip.style.left = `${e.pageX + 10}px`;
                tooltip.style.top = `${e.pageY + 10}px`;
              },
              onMouseOut: (e) => {
                e.target.setAttribute("opacity", "1");
                document
                  .querySelectorAll('div[style*="position: absolute"]')
                  .forEach((el) => el.remove());
              },
            });
          });
          return React.createElement(
            "div",
            { className: "chart-container" },
            React.createElement(
              "svg",
              { className: "svg-pie-chart", viewBox: "0 0 300 300" },
              slices
            ),
            React.createElement(
              "div",
              { className: "legend-container" },
              pieChartData.map(({ category, color }) =>
                React.createElement(
                  "div",
                  { key: category, className: "legend-item" },
                  React.createElement("div", {
                    className: "legend-color",
                    style: { backgroundColor: color },
                  }),
                  React.createElement("span", null, category)
                )
              )
            )
          );
        };

        const monthlySummary = filteredTransactions.reduce((acc, t) => {
          const date = new Date(t.date);
          if (isNaN(date.getTime())) return acc;
          const month = date.toLocaleString("he-IL", {
            month: "long",
            year: "numeric",
          });
          if (!acc[month]) acc[month] = { income: 0, expenses: 0 };
          if (t.type === "income") acc[month].income += t.amount;
          else acc[month].expenses += t.amount;
          return acc;
        }, {});

        const totalSavings = savings.reduce((sum, s) => sum + s.amount, 0);
        const previousSavings = savings
          .slice(0, -1)
          .reduce((sum, s) => sum + s.amount, 0);
        const savingsChange =
          savings.length > 1
            ? (
                ((totalSavings - previousSavings) / previousSavings) *
                100
              ).toFixed(2)
            : 0;

        const generateInsights = () => {
          const insights = [];
          const expenseCategories = filteredTransactions
            .filter((t) => t.type === "expense")
            .reduce((acc, t) => {
              acc[t.category] = (acc[t.category] || 0) + t.amount;
              return acc;
            }, {});
          const topCategory = Object.entries(expenseCategories).reduce(
            (max, [cat, amount]) =>
              amount > (max.amount || 0) ? { category: cat, amount } : max,
            {}
          );
          if (topCategory.category) {
            insights.push(
              `הקטגוריה עם ההוצאה הגבוהה ביותר היא "${
                topCategory.category
              }" עם סך של ${topCategory.amount.toFixed(
                2
              )} ₪. שקול לבדוק אפשרויות לחיסכון בקטגוריה זו.`
            );
          }
          if (balance < 0) {
            insights.push(
              `המאזן שלך שלילי (${balance.toFixed(
                2
              )} ₪). מומלץ להפחית הוצאות או להגדיל הכנסות כדי לשפר את המצב הפיננסי.`
            );
          } else if (balance < totalExpenses * 0.1) {
            insights.push(
              `המאזן שלך (${balance.toFixed(
                2
              )} ₪) נמוך יחסית להוצאות (${totalExpenses.toFixed(
                2
              )} ₪). שקול להגדיר תקציב חודשי להוצאות.`
            );
          } else {
            insights.push(
              `המאזן שלך חיובי (${balance.toFixed(
                2
              )} ₪). כל הכבוד! המשך לנהל את הכספים שלך בחוכמה.`
            );
          }
          if (totalSavings === 0) {
            insights.push(
              "לא נרשמו חסכונות. מומלץ להתחיל להפריש סכומים לחיסכון לעתיד יציב יותר."
            );
          } else if (savingsChange < 0) {
            insights.push(
              `החסכונות שלך ירדו ב-${Math.abs(
                savingsChange
              )}%. בדוק אם יש הוצאות בלתי צפויות שמשפיעות על החסכונות.`
            );
          } else if (savingsChange > 0) {
            insights.push(
              `החסכונות שלך גדלו ב-${savingsChange}%! המשך להגדיל את החסכונות שלך על ידי הפרשות קבועות.`
            );
          } else {
            insights.push(
              `החסכונות שלך נשארו ללא שינוי (${totalSavings.toFixed(
                2
              )} ₪). שקול להגדיל את ההפרשות החודשיות לחיסכון.`
            );
          }
          const savingsByLocation = savings.reduce((acc, s) => {
            acc[s.location] = (acc[s.location] || 0) + s.amount;
            return acc;
          }, {});
          const dominantLocation = Object.entries(savingsByLocation).reduce(
            (max, [loc, amount]) =>
              amount > (max.amount || 0) ? { location: loc, amount } : max,
            {}
          );
          if (
            dominantLocation.location &&
            dominantLocation.amount / totalSavings > 0.7
          ) {
            insights.push(
              `רוב החסכונות שלך (${(
                (dominantLocation.amount / totalSavings) *
                100
              ).toFixed(1)}%) נמצאים ב"${
                dominantLocation.location
              }". שקול לגוון את החסכונות שלך כדי להפחית סיכונים.`
            );
          }
          const monthlyExpenses =
            Object.values(monthlySummary).reduce(
              (sum, m) => sum + m.expenses,
              0
            ) / Object.keys(monthlySummary).length;
          if (monthlyExpenses > totalIncome * 0.5 && monthlyExpenses > 0) {
            insights.push(
              `ההוצאות החודשיות הממוצעות שלך (${monthlyExpenses.toFixed(
                2
              )} ₪) מהוות יותר מ-50% מההכנסות. מומלץ להגדיר תקציב קבוע להוצאות כדי לשמור על יציבות פיננסית.`
            );
          }
          return insights.length > 0
            ? insights
            : [
                "אין מספיק נתונים כדי לספק תובנות. הוסף פעולות וחסכונות לקבלת המלצות מותאמות.",
              ];
        };

        const exportToCSV = () => {
          const headers = "תיאור,סכום,סוג,קטגוריה,תאריך\n";
          const csv =
            headers +
            filteredTransactions
              .map(
                (t) =>
                  `"${t.description}",${t.amount},"${
                    t.type === "expense" ? "הוצאה" : "הכנסה"
                  }","${t.category}","${new Date(t.date).toLocaleDateString(
                    "he-IL"
                  )}"`
              )
              .join("\n");
          const blob = new Blob([new Uint8Array([0xef, 0xbb, 0xbf]), csv], {
            type: "text/csv;charset=utf-8",
          });
          const url = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.href = url;
          link.download = "transactions.csv";
          link.click();
          URL.revokeObjectURL(url);
        };

        return React.createElement(
          "div",
          { className: "container my-4" },
          React.createElement("div", {
            id: "toastContainer",
            className: "toast-container",
          }),
          React.createElement(
            "div",
            {
              className: "modal fade",
              id: "editTransactionModal",
              tabIndex: "-1",
              "aria-labelledby": "editTransactionModalLabel",
              "aria-hidden": "true",
            },
            React.createElement(
              "div",
              { className: "modal-dialog" },
              React.createElement(
                "div",
                { className: "modal-content" },
                React.createElement(
                  "div",
                  { className: "modal-header" },
                  React.createElement(
                    "h5",
                    {
                      className: "modal-title fw-bold",
                      id: "editTransactionModalLabel",
                    },
                    "עריכת פעולה"
                  ),
                  React.createElement("button", {
                    type: "button",
                    className: "btn-close",
                    "data-bs-dismiss": "modal",
                    "aria-label": "סגור",
                  })
                ),
                React.createElement(
                  "div",
                  { className: "modal-body" },
                  editError &&
                    React.createElement(
                      "p",
                      { className: "text-danger mb-3" },
                      editError
                    ),
                  React.createElement(
                    "div",
                    { className: "row g-3" },
                    React.createElement(
                      "div",
                      { className: "col-md-6" },
                      React.createElement("input", {
                        type: "text",
                        placeholder: "תיאור",
                        value: editDescription,
                        onChange: (e) => setEditDescription(e.target.value),
                        className: "form-control",
                      })
                    ),
                    React.createElement(
                      "div",
                      { className: "col-md-6" },
                      React.createElement("input", {
                        type: "number",
                        placeholder: "סכום",
                        value: editAmount,
                        onChange: (e) => setEditAmount(e.target.value),
                        className: "form-control",
                      })
                    ),
                    React.createElement(
                      "div",
                      { className: "col-md-6" },
                      React.createElement(
                        "select",
                        {
                          value: editType,
                          onChange: (e) => setEditType(e.target.value),
                          className: "form-select",
                        },
                        React.createElement(
                          "option",
                          { value: "expense" },
                          "הוצאה"
                        ),
                        React.createElement(
                          "option",
                          { value: "income" },
                          "הכנסה"
                        )
                      )
                    ),
                    React.createElement(
                      "div",
                      { className: "col-md-6" },
                      React.createElement(
                        "select",
                        {
                          value: editCategory,
                          onChange: (e) => setEditCategory(e.target.value),
                          className: "form-select",
                        },
                        React.createElement(
                          "option",
                          { value: "" },
                          "בחר קטגוריה"
                        ),
                        predefinedCategories.map((cat) =>
                          React.createElement(
                            "option",
                            { key: cat, value: cat },
                            cat
                          )
                        )
                      )
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "modal-footer" },
                  React.createElement(
                    "button",
                    {
                      type: "button",
                      className: "btn btn-outline-secondary",
                      "data-bs-dismiss": "modal",
                    },
                    "ביטול"
                  ),
                  React.createElement(
                    "button",
                    {
                      type: "button",
                      className: "btn btn-primary",
                      onClick: editTransactionSubmit,
                    },
                    "שמור שינויים"
                  )
                )
              )
            )
          ),
          React.createElement(
            "div",
            {
              className: "modal fade",
              id: "settingsModal",
              tabIndex: "-1",
              "aria-labelledby": "settingsModalLabel",
              "aria-hidden": "true",
            },
            React.createElement(
              "div",
              { className: "modal-dialog" },
              React.createElement(
                "div",
                { className: "modal-content" },
                React.createElement(
                  "div",
                  { className: "modal-header" },
                  React.createElement(
                    "h5",
                    {
                      className: "modal-title fw-bold",
                      id: "settingsModalLabel",
                    },
                    "הגדרות"
                  ),
                  React.createElement("button", {
                    type: "button",
                    className: "btn-close",
                    "data-bs-dismiss": "modal",
                    "aria-label": "סגור",
                  })
                ),
                React.createElement(
                  "div",
                  { className: "modal-body" },
                  React.createElement(
                    "div",
                    { className: "mb-3" },
                    React.createElement(
                      "label",
                      { className: "form-label fw-bold" },
                      "גודל טקסט ותוכן"
                    ),
                    React.createElement(
                      "select",
                      {
                        value: fontSize,
                        onChange: (e) => setFontSize(e.target.value),
                        className: "form-select",
                      },
                      React.createElement("option", { value: "small" }, "קטן"),
                      React.createElement(
                        "option",
                        { value: "medium" },
                        "בינוני"
                      ),
                      React.createElement("option", { value: "large" }, "גדול")
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "modal-footer" },
                  React.createElement(
                    "button",
                    {
                      type: "button",
                      className: "btn btn-outline-secondary",
                      "data-bs-dismiss": "modal",
                    },
                    "סגור"
                  )
                )
              )
            )
          ),
          React.createElement(
            "button",
            {
              className: "btn btn-primary position-fixed top-0 end-0 m-3",
              type: "button",
              "data-bs-toggle": "offcanvas",
              "data-bs-target": "#offcanvasSidebar",
              "aria-controls": "offcanvasSidebar",
            },
            "☰"
          ),
          React.createElement(
            "div",
            {
              className: "offcanvas offcanvas-end bg-light",
              tabIndex: "-1",
              id: "offcanvasSidebar",
              "aria-labelledby": "offcanvasSidebarLabel",
            },
            React.createElement(
              "div",
              { className: "offcanvas-header" },
              React.createElement(
                "h5",
                {
                  className: "offcanvas-title fw-bold",
                  id: "offcanvasSidebarLabel",
                },
                "תפריט"
              ),
              React.createElement("button", {
                type: "button",
                className: "btn-close",
                "data-bs-dismiss": "offcanvas",
                "aria-label": "סגור",
              })
            ),
            React.createElement(
              "div",
              { className: "offcanvas-body" },
              React.createElement(
                "nav",
                { className: "nav flex-column gap-3" },
                React.createElement(
                  "a",
                  {
                    className: `nav-link btn-nav ${
                      activeTab === "transactions" ? "active" : ""
                    }`,
                    href: "#",
                    onClick: (e) => {
                      e.preventDefault();
                      setActiveTab("transactions");
                    },
                  },
                  "פעולות"
                ),
                React.createElement(
                  "a",
                  {
                    className: `nav-link btn-nav ${
                      activeTab === "savings" ? "active" : ""
                    }`,
                    href: "#",
                    onClick: (e) => {
                      e.preventDefault();
                      setActiveTab("savings");
                    },
                  },
                  "חסכונות"
                ),
                React.createElement(
                  "a",
                  {
                    className: `nav-link btn-nav ${
                      activeTab === "insights" ? "active" : ""
                    }`,
                    href: "#",
                    onClick: (e) => {
                      e.preventDefault();
                      setActiveTab("insights");
                    },
                  },
                  "תובנות"
                ),
                React.createElement(
                  "div",
                  { className: "d-flex justify-content-between mt-auto" },
                  React.createElement(
                    "button",
                    {
                      className: "btn btn-settings",
                      onClick: openSettingsModal,
                      title: "הגדרות",
                    },
                    React.createElement("i", { className: "bi bi-gear-fill" })
                  ),
                  React.createElement(
                    "button",
                    {
                      className: "btn btn-settings",
                      onClick: () => setDarkMode(!darkMode),
                      title: darkMode ? "מצב יום" : "מצב לילה",
                    },
                    darkMode ? "☀️" : "🌙"
                  )
                )
              )
            )
          ),
          React.createElement(
            "div",
            { className: "me-3 position-relative" },
            React.createElement(
              "div",
              { className: "about-icon" },
              React.createElement("i", { className: "bi bi-info-square-fill" }),
              React.createElement(
                "div",
                { className: "about-tooltip" },
                "Finely - ניהול פיננסי חכם לעקוב אחר הכנסות, הוצאות וחסכונות עם ממשק נוח וגרפים ברורים"
              )
            ),
            React.createElement("h1", { className: "fade-in" }, "Finely"),
            activeTab === "transactions" &&
              React.createElement(
                "div",
                null,
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#transactionFormCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "transactionFormCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "הוספת פעולה"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "transactionFormCollapse",
                    },
                    error &&
                      React.createElement(
                        "p",
                        { className: "text-danger mb-3" },
                        error
                      ),
                    React.createElement(
                      "div",
                      { className: "row g-3" },
                      React.createElement(
                        "div",
                        { className: "col-md-6" },
                        React.createElement("input", {
                          type: "text",
                          placeholder: "תיאור",
                          value: description,
                          onChange: (e) => setDescription(e.target.value),
                          className: "form-control",
                        })
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-6" },
                        React.createElement("input", {
                          type: "number",
                          placeholder: "סכום",
                          value: amount,
                          onChange: (e) => setAmount(e.target.value),
                          className: "form-control",
                        })
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-6" },
                        React.createElement(
                          "select",
                          {
                            value: type,
                            onChange: (e) => setType(e.target.value),
                            className: "form-select",
                          },
                          React.createElement(
                            "option",
                            { value: "expense" },
                            "הוצאה"
                          ),
                          React.createElement(
                            "option",
                            { value: "income" },
                            "הכנסה"
                          )
                        )
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-6" },
                        React.createElement(
                          "select",
                          {
                            value: category,
                            onChange: (e) => setCategory(e.target.value),
                            className: "form-select",
                          },
                          React.createElement(
                            "option",
                            { value: "" },
                            "בחר קטגוריה"
                          ),
                          predefinedCategories.map((cat) =>
                            React.createElement(
                              "option",
                              { key: cat, value: cat },
                              cat
                            )
                          )
                        )
                      ),
                      React.createElement(
                        "div",
                        { className: "col-12" },
                        React.createElement(
                          "button",
                          {
                            onClick: addTransaction,
                            className: "btn btn-primary w-100",
                          },
                          "הוסף פעולה"
                        )
                      )
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#filtersCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "filtersCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "סינון פעולות"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "filtersCollapse",
                    },
                    React.createElement(
                      "div",
                      { className: "row g-3" },
                      React.createElement(
                        "div",
                        { className: "col-md-3" },
                        React.createElement(
                          "select",
                          {
                            value: filterType,
                            onChange: (e) => setFilterType(e.target.value),
                            className: "form-select",
                          },
                          React.createElement(
                            "option",
                            { value: "all" },
                            "כל הסוגים"
                          ),
                          React.createElement(
                            "option",
                            { value: "expense" },
                            "הוצאות"
                          ),
                          React.createElement(
                            "option",
                            { value: "income" },
                            "הכנסות"
                          )
                        )
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-3" },
                        React.createElement(
                          "select",
                          {
                            value: filterCategory,
                            onChange: (e) => setFilterCategory(e.target.value),
                            className: "form-select",
                          },
                          React.createElement(
                            "option",
                            { value: "all" },
                            "כל הקטגוריות"
                          ),
                          predefinedCategories.map((cat) =>
                            React.createElement(
                              "option",
                              { key: cat, value: cat },
                              cat
                            )
                          )
                        )
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-6" },
                        React.createElement(
                          "div",
                          { className: "row g-3" },
                          React.createElement(
                            "div",
                            { className: "col-md-6" },
                            React.createElement("input", {
                              type: "date",
                              value: filterDateStart,
                              onChange: (e) =>
                                setFilterDateStart(e.target.value),
                              className: "form-control",
                            })
                          ),
                          React.createElement(
                            "div",
                            { className: "col-md-6" },
                            React.createElement("input", {
                              type: "date",
                              value: filterDateEnd,
                              onChange: (e) => setFilterDateEnd(e.target.value),
                              className: "form-control",
                            })
                          )
                        )
                      )
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#summaryCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "summaryCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "סיכום"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "summaryCollapse",
                    },
                    React.createElement(
                      "div",
                      { className: "row g-3" },
                      React.createElement(
                        "div",
                        { className: "col-md-4" },
                        React.createElement(
                          "div",
                          { className: "card bg-success text-white" },
                          React.createElement(
                            "div",
                            { className: "card-body" },
                            React.createElement(
                              "h3",
                              { className: "card-title h6 fw-bold" },
                              "הכנסות"
                            ),
                            React.createElement(
                              "p",
                              { className: "card-text fs-5" },
                              totalIncome.toLocaleString("he-IL", {
                                minimumFractionDigits: 2,
                              }) + " ₪"
                            )
                          )
                        )
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-4" },
                        React.createElement(
                          "div",
                          { className: "card bg-danger text-white" },
                          React.createElement(
                            "div",
                            { className: "card-body" },
                            React.createElement(
                              "h3",
                              { className: "card-title h6 fw-bold" },
                              "הוצאות"
                            ),
                            React.createElement(
                              "p",
                              { className: "card-text fs-5" },
                              totalExpenses.toLocaleString("he-IL", {
                                minimumFractionDigits: 2,
                              }) + " ₪"
                            )
                          )
                        )
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-4" },
                        React.createElement(
                          "div",
                          { className: "card bg-primary text-white" },
                          React.createElement(
                            "div",
                            { className: "card-body" },
                            React.createElement(
                              "h3",
                              { className: "card-title h6 fw-bold" },
                              "מאזן"
                            ),
                            React.createElement(
                              "p",
                              { className: "card-text fs-5" },
                              balance.toLocaleString("he-IL", {
                                minimumFractionDigits: 2,
                              }) + " ₪"
                            )
                          )
                        )
                      )
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#pieChartCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "pieChartCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "פילוח לפי קטגוריה"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "pieChartCollapse",
                    },
                    generatePieChart()
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#monthlySummaryCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "monthlySummaryCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "סיכום חודשי"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "monthlySummaryCollapse",
                    },
                    React.createElement(
                      "div",
                      { className: "row g-3" },
                      Object.entries(monthlySummary).map(([month, data]) =>
                        React.createElement(
                          "div",
                          { key: month, className: "col-md-4" },
                          React.createElement(
                            "div",
                            { className: "card bg-light" },
                            React.createElement(
                              "div",
                              { className: "card-body" },
                              React.createElement(
                                "h3",
                                { className: "card-title h6 fw-bold" },
                                month
                              ),
                              React.createElement(
                                "p",
                                { className: "card-text" },
                                "הכנסות: " +
                                  data.income.toLocaleString("he-IL", {
                                    minimumFractionDigits: 2,
                                  }) +
                                  " ₪"
                              ),
                              React.createElement(
                                "p",
                                { className: "card-text" },
                                "הוצאות: " +
                                  data.expenses.toLocaleString("he-IL", {
                                    minimumFractionDigits: 2,
                                  }) +
                                  " ₪"
                              ),
                              React.createElement(
                                "p",
                                { className: "card-text" },
                                "מאזן: " +
                                  (data.income - data.expenses).toLocaleString(
                                    "he-IL",
                                    { minimumFractionDigits: 2 }
                                  ) +
                                  " ₪"
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in category-summary" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#categorySummaryCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "categorySummaryCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "סיכום לפי קטגוריה"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "categorySummaryCollapse",
                    },
                    React.createElement(
                      "div",
                      { className: "row g-3" },
                      Object.entries(categorySummary).map(
                        ([cat, amount], index) =>
                          React.createElement(
                            "div",
                            { key: cat, className: "col-md-6" },
                            React.createElement(
                              "div",
                              { className: "d-flex align-items-center" },
                              React.createElement(
                                "span",
                                { className: "fw-bold" },
                                cat
                              ),
                              React.createElement(
                                "span",
                                {
                                  className:
                                    amount >= 0
                                      ? "text-success"
                                      : "text-danger",
                                },
                                amount.toLocaleString("he-IL", {
                                  minimumFractionDigits: 2,
                                }) + " ₪"
                              )
                            ),
                            index < Object.keys(categorySummary).length - 1 &&
                              React.createElement("hr", null)
                          )
                      )
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card bg-light fade-in" },
                  React.createElement(
                    "div",
                    {
                      className:
                        "card-header d-flex justify-content-between align-items-center",
                    },
                    React.createElement(
                      "button",
                      {
                        className: "collapse-toggle",
                        type: "button",
                        "data-bs-toggle": "collapse",
                        "data-bs-target": "#transactionsTableCollapse",
                        "aria-expanded": "true",
                        "aria-controls": "transactionsTableCollapse",
                      },
                      React.createElement(
                        "h2",
                        { className: "card-title h5 fw-bold mb-0" },
                        "רשימת פעולות"
                      ),
                      React.createElement("i", {
                        className: "bi bi-chevron-down",
                      })
                    ),
                    React.createElement(
                      "button",
                      { onClick: exportToCSV, className: "btn btn-success" },
                      "יצוא ל-CSV"
                    )
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "transactionsTableCollapse",
                    },
                    React.createElement(
                      "div",
                      { className: "table-responsive" },
                      React.createElement(
                        "table",
                        { className: "table table-bordered" },
                        React.createElement(
                          "thead",
                          null,
                          React.createElement(
                            "tr",
                            null,
                            React.createElement("th", null, "תיאור"),
                            React.createElement("th", null, "סכום"),
                            React.createElement("th", null, "סוג"),
                            React.createElement("th", null, "קטגוריה"),
                            React.createElement("th", null, "תאריך"),
                            React.createElement("th", null, "פעולות")
                          )
                        ),
                        React.createElement(
                          "tbody",
                          null,
                          filteredTransactions.map((t) =>
                            React.createElement(
                              "tr",
                              { key: t.id },
                              React.createElement("td", null, t.description),
                              React.createElement(
                                "td",
                                null,
                                t.amount.toLocaleString("he-IL", {
                                  minimumFractionDigits: 2,
                                }) + " ₪"
                              ),
                              React.createElement(
                                "td",
                                null,
                                t.type === "expense" ? "הוצאה" : "הכנסה"
                              ),
                              React.createElement("td", null, t.category),
                              React.createElement(
                                "td",
                                null,
                                new Date(t.date).toLocaleDateString("he-IL")
                              ),
                              React.createElement(
                                "td",
                                null,
                                React.createElement(
                                  "button",
                                  {
                                    onClick: () => openEditModal(t),
                                    className: "btn btn-link text-primary me-2",
                                  },
                                  "ערוך"
                                ),
                                React.createElement(
                                  "button",
                                  {
                                    onClick: () => deleteTransaction(t.id),
                                    className: "btn btn-link text-danger",
                                  },
                                  "מחק"
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              ),
            activeTab === "savings" &&
              React.createElement(
                "div",
                null,
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#savingsFormCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "savingsFormCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "הוספת חיסכון"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "savingsFormCollapse",
                    },
                    savingsError &&
                      React.createElement(
                        "p",
                        { className: "text-danger mb-3" },
                        savingsError
                      ),
                    React.createElement(
                      "div",
                      { className: "row g-3" },
                      React.createElement(
                        "div",
                        { className: "col-md-4" },
                        React.createElement("input", {
                          type: "text",
                          placeholder: "שם החיסכון",
                          value: savingsName,
                          onChange: (e) => setSavingsName(e.target.value),
                          className: "form-control",
                        })
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-4" },
                        React.createElement("input", {
                          type: "number",
                          placeholder: "סכום",
                          value: savingsAmount,
                          onChange: (e) => setSavingsAmount(e.target.value),
                          className: "form-control",
                        })
                      ),
                      React.createElement(
                        "div",
                        { className: "col-md-4" },
                        React.createElement(
                          "select",
                          {
                            value: savingsLocation,
                            onChange: (e) => setSavingsLocation(e.target.value),
                            className: "form-select",
                          },
                          React.createElement(
                            "option",
                            { value: "" },
                            "בחר מיקום"
                          ),
                          predefinedLocations.map((loc) =>
                            React.createElement(
                              "option",
                              { key: loc, value: loc },
                              loc
                            )
                          )
                        )
                      ),
                      React.createElement(
                        "div",
                        { className: "col-12" },
                        React.createElement(
                          "button",
                          {
                            onClick: addSavings,
                            className: "btn btn-primary w-100",
                          },
                          "הוסף חיסכון"
                        )
                      )
                    )
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#savingsChartCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "savingsChartCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "גרף חסכונות"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "savingsChartCollapse",
                    },
                    savings.length === 0
                      ? React.createElement(
                          "div",
                          { className: "text-center text-muted" },
                          "אין נתונים להצגה"
                        )
                      : React.createElement("canvas", { ref: savingsChartRef })
                  )
                ),
                React.createElement(
                  "div",
                  { className: "card bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#savingsTableCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "savingsTableCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "רשימת חסכונות"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "savingsTableCollapse",
                    },
                    React.createElement(
                      "div",
                      { className: "table-responsive" },
                      React.createElement(
                        "table",
                        { className: "table table-bordered" },
                        React.createElement(
                          "thead",
                          null,
                          React.createElement(
                            "tr",
                            null,
                            React.createElement("th", null, "שם החיסכון"),
                            React.createElement("th", null, "סכום"),
                            React.createElement("th", null, "מיקום"),
                            React.createElement("th", null, "תאריך"),
                            React.createElement("th", null, "פעולות")
                          )
                        ),
                        React.createElement(
                          "tbody",
                          null,
                          savings.map((s) =>
                            React.createElement(
                              "tr",
                              { key: s.id },
                              React.createElement("td", null, s.name),
                              React.createElement(
                                "td",
                                null,
                                s.amount.toLocaleString("he-IL", {
                                  minimumFractionDigits: 2,
                                }) + " ₪"
                              ),
                              React.createElement("td", null, s.location),
                              React.createElement(
                                "td",
                                null,
                                new Date(s.date).toLocaleDateString("he-IL")
                              ),
                              React.createElement(
                                "td",
                                null,
                                React.createElement(
                                  "button",
                                  {
                                    onClick: () => deleteSavings(s.id),
                                    className: "btn btn-link text-danger",
                                  },
                                  "מחק"
                                )
                              )
                            )
                          )
                        )
                      )
                    )
                  )
                )
              ),
            activeTab === "insights" &&
              React.createElement(
                "div",
                null,
                React.createElement(
                  "div",
                  { className: "card mb-4 bg-light fade-in" },
                  React.createElement(
                    "button",
                    {
                      className: "card-header collapse-toggle",
                      type: "button",
                      "data-bs-toggle": "collapse",
                      "data-bs-target": "#insightsCollapse",
                      "aria-expanded": "true",
                      "aria-controls": "insightsCollapse",
                    },
                    React.createElement(
                      "h2",
                      { className: "card-title h5 fw-bold mb-0" },
                      "תובנות פיננסיות"
                    ),
                    React.createElement("i", {
                      className: "bi bi-chevron-down",
                    })
                  ),
                  React.createElement(
                    "div",
                    {
                      className: "card-body collapse show",
                      id: "insightsCollapse",
                    },
                    React.createElement(
                      "ul",
                      { className: "insights-list" },
                      generateInsights().map((insight, index) =>
                        React.createElement("li", { key: index }, insight)
                      )
                    )
                  )
                )
              ),
            React.createElement(
              "footer",
              { className: "footer" },
              "©  2025 Finely - כל הזכויות שמורות לטל יעקב"
            )
          )
        );
      };

      ReactDOM.render(
        React.createElement(FinanceApp),
        document.getElementById("root")
      );
    </script>
  </body>
</html>
